!function(t,e,s){"use strict";function n(t){var e,n=s("#tm_epo_consent_for_transmit");n.length&&n.is(":checked")&&0===y&&(y=1,s(".tm-license-button").block({message:null}),e={action:"tm_"+t+"_license",username:s("#tm_epo_envato_username").val(),key:s("#tm_epo_envato_purchasecode").val(),api_key:s("#tm_epo_envato_apikey").val(),security:v.settings_nonce},s.post(v.ajax_url,e,function(t){var e;e=t&&-1!==t?t&&t.message&&t.result&&("-3"===t.result||"-2"===t.result||"wp_error"===t.result||"server_error"===t.result)?t.message:t&&t.message&&t.result&&"4"===t.result?t.message:"":v.i18n_invalid_request,s(".tm-license-result").html(e),s(".tm-license-button").unblock()},"json").always(function(e){s(".tm-license-button").unblock(),y=0,e&&e.result&&"4"===e.result&&("activate"===t&&(s(".tm-deactivate-license").removeClass("tm-hidden"),s(".tm-activate-license").removeClass("tm-hidden").addClass("tm-hidden")),"deactivate"===t&&(s(".tm-deactivate-license").removeClass("tm-hidden").addClass("tm-hidden"),s(".tm-activate-license").removeClass("tm-hidden")))}))}function o(t){var e=t.val(),n=s("#tm_epo_options_placement_custom_hook").closest("tr");"custom"===e?n.show():n.hide()}function a(t){var e=t.val(),n=s("#tm_epo_totals_box_placement_custom_hook").closest("tr");"custom"===e?n.show():n.hide()}function i(t){var e=t.val(),n=s("#tm_epo_options_placement").closest("tr"),i=s("#tm_epo_totals_box_placement").closest("tr"),l=s("#tm_epo_options_placement_custom_hook").closest("tr"),c=s("#tm_epo_totals_box_placement_custom_hook").closest("tr");"action"===e?(n.hide(),i.hide(),l.hide(),c.hide()):(n.show(),i.show(),o(s("#tm_epo_options_placement")),a(s("#tm_epo_totals_box_placement")))}function l(t){var e=t.val(),n=s("#tm_epo_floating_totals_box_visibility").closest("tr"),o=s("#tm_epo_floating_totals_box_add_button").closest("tr");"disable"===e?(n.hide(),o.hide()):(n.show(),o.show())}function c(t){var e=t.is(":checked"),n=s("#tm_epo_show_price_inside_option_hidden_even").closest("tr"),o=s("#tm_epo_multiply_price_inside_option").closest("tr");e?(n.show(),o.show()):(n.hide(),o.hide())}function m(t){var e=t.is(":checked"),n=s("#tm_epo_show_upload_image_replacement").closest("tr");e?n.hide():n.show()}function r(t){s(t).closest("td").css("position","relative").append('<label class="tm-epo-field-label"><span class="tm-epo-style-wrapper"><input type="checkbox" checked><span class="tm-epo-style"></span></span></label><label class="tm-epo-field-label"><span class="tm-epo-style-wrapper"><input type="radio" checked><span class="tm-epo-style"></span></span></label>')}function _(t){var e=t.val();s(".tm-epo-field-label").find(".tm-epo-style-wrapper, .tm-epo-style").removeClass("square square2 round round2").addClass(e)}function d(t){var e=t.val(),n=s("#tm_epo_css_styles_style").closest("tr");"on"===e?n.show():n.hide()}function p(t){s(t).closest("td").css("position","relative").append('<div class="tm-border-type"></div>')}function u(t){var e=t.val();s(".tm-border-type").removeClass("square round shadow thinline").addClass(e)}function f(t){return t.closest("tr")}function h(t,e,s,n){f(s).addClass("tm-hidden"),f(s.filter("."+t)).removeClass("tm-hidden"),n.find(".tm-section-desc .tm-section-menu-item").removeClass("active"),e.addClass("active")}var v=t.TMEPOADMINSETTINGSJS,b=s.epoAPI.util.getStorage("localStorage"),g=t.confirm,w=t.toastr,y=0;s(e).ready(function(){var f,y=s(".tm-settings-wrap");y.length>0&&((f=y.find(":checkbox")).closest("label").addClass("tm-epo-switch-wrapper-label"),f.wrap('<span class="tm-epo-switch-wrapper tc"></span>'),f.after('<span class="tc-label tm-epo-switch tc"></span>'),s(".forminp .description").toArray().forEach(function(t,e){var n=s(t);n.closest("tr").find(".titledesc").append(n)}),s("#tm_epo_consent_for_transmit").closest("tr").after(s('<tr valign="top"><th scope="row" class="titledesc tm-license-div"></th><td class="forminp forminp-license"></td></tr>')),s(".tm-license-div").append(s(".tm-license-button")),s(".forminp-license").append(s(".tm-license-result")),s(t).on("tc-opentab.tmtabs tc-isopentab.tmtabs",function(t,e){var n,o,a,i=e.table.find(".tm-section-desc .tm-section-menu-item");i.length>0&&(b&&(n=b.getItem("tmadminextratab")),o=i.filter('[data-menu="'+n+'"]'),a=e.table.find("select,input,text,textarea"),n&&0!==o.length||(n=(o=s(i).eq(0)).attr("data-menu")),h(n,o,a,e.table))}),s(e).on("keydown.tmtabs",".tm-section-menu-item",function(t){var e,n=s(this);13===t.keyCode&&n.trigger("click"),39===t.keyCode&&(e=n.next(".tm-section-menu-item")),37===t.keyCode&&(e=n.prev(".tm-section-menu-item")),e&&e.length&&(n.blur(),e.focus().trigger("click"),t.preventDefault())}),s(e).on("click",".tm-section-menu-item",function(){var t=s(this),e=t.attr("data-menu"),n=t.closest(".tm-tab");h(e,t,n.find("select,input,text,textarea"),n),b&&b.setItem("tmadminextratab",e)}),s(t).on("tc-tmtabs-clicked",function(t,e){var n,o,a,i,l,c=e.table.find(".tm-section-desc .tm-section-menu-item");c.length>0&&(b&&(n=b.getItem("tmadminextratab")),b&&(o=b.getItem("tmadminextratab-context")),a=e.header.attr(e.options.dataattribute),l=e.table.find("select,input,text,textarea"),n&&o===a?i=c.filter('[data-menu="'+n+'"]'):n=(i=s(c).eq(0)).attr("data-menu"),b&&b.setItem("tmadminextratab-context",a),i.length>0&&!i.is(".active")&&h(n,i,l,e.table))}),s(e).on("click",".tc-save-button",function(t){var e=s(this).closest("form"),n=e.tcSerializeObject();n=s.extend(!0,n,{action:"tm_save_settings",save:"save",security:v.settings_nonce}),t.preventDefault(),e.block({message:null}),s.post(v.ajax_url,n,function(t){t&&(1===t.error?w.error(t.message,v.i18n_epo):w.success(t.message,v.i18n_epo))},"json").always(function(){e.unblock()})}),s(".tm-settings-wrap .tm-tabs").tmtabs(),s(".tm-activate-license").on("click",function(t){t.preventDefault(),n("activate")}),s(".tm-deactivate-license").on("click",function(t){t.preventDefault(),n("deactivate")}),s("#tm_epo_display").on("change",function(){i(s(this))}),s("#tm_epo_options_placement").on("change",function(){o(s(this))}),s("#tm_epo_totals_box_placement").on("change",function(){a(s(this))}),s("#tm_epo_css_styles").on("change",function(){d(s(this))}),s("#tm_epo_css_styles_style").on("change",function(){_(s(this))}),s("#tm_epo_css_selected_border").on("change",function(){u(s(this))}),s("#tm_epo_floating_totals_box").on("change",function(){l(s(this))}),s("#tm_epo_show_price_inside_option").on("change",function(){c(s(this))}),s("#tm_epo_show_hide_uploaded_file_url_cart").on("change",function(){m(s(this))}),i(s("#tm_epo_display")),o(s("#tm_epo_options_placement")),a(s("#tm_epo_totals_box_placement")),r(s("#tm_epo_css_styles_style")),_(s("#tm_epo_css_styles_style")),d(s("#tm_epo_css_styles")),p(s("#tm_epo_css_selected_border")),u(s("#tm_epo_css_selected_border")),l(s("#tm_epo_floating_totals_box")),c(s("#tm_epo_show_price_inside_option")),m(s("#tm_epo_show_hide_uploaded_file_url_cart")),s(e).on("click.cpf",".tm-mn-movetodir,.tm-mn-deldir,.tm-mn-delfile",function(t){var e,n=s(this),o=s(".forminp-tm_html");if(t.preventDefault(),o.length>0){if(o.data("doing_ajax"))return;if(n.is(".tm-mn-deldir")&&!g(v.i18n_mn_delete_folder))return;if(n.is(".tm-mn-delfile")&&!g(v.i18n_mn_delete_file))return;n.prepend('<i class="tm-icon tcfa tcfa-spin tcfa-spinner"></i>'),o.data("doing_ajax",1).block({message:null}),e={action:"tm_mn_movetodir",dir:n.attr("data-tm-dir"),security:v.settings_nonce},n.is(".tm-mn-deldir")?(e.action="tm_mn_deldir",e.tmdir=n.attr("data-tm-deldir")):n.is(".tm-mn-delfile")&&(e.action="tm_mn_delfile",e.tmfile=n.attr("data-tm-delfile"),e.tmdir=n.attr("data-tm-deldir")),s.post(v.ajax_url,e,function(t){var e;t&&t.result&&""!==t.result?o.html(t.result):t&&t.error&&t.message&&(e=s.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:'<div class="tm-inner">'+t.message+"</div>",title:v.i18n_error_title}),s.tcFloatBox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"50%",height:"300px",classname:"flasho tm_wrapper tm-error",data:e}))},"json").always(function(){o.data("doing_ajax",0).unblock(),n.find(".tm-icon").remove()})}})),s.tcToolTip()})}(window,document,window.jQuery);